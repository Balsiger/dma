<div
  class="entity {{ type() }}"
  [class.collapsed]="collapsed()"
  [class.expanded]="!collapsed()"
  [class.overview]="overview"
  (click)="onMaybeExpand($event)"
>
  <div class="bar"></div>

  <div class="content">
    <div class="name">
      @if (!found()) {
        <div class="not-found">
          <mat-icon title="Not found">warning</mat-icon>
          <div class="text">Not found</div>
        </div>
      }
      <div class="name-text">
        @if (count() > 1) {
          {{ count() }}x
        }
        {{ name() }}
        @if (bases().length) {
          <div class="bases">
            (
            @for (base of bases(); track base; let last = $last) {
              <reference [name]="base" [type]="baseType()" [color]="false" [campaign]="campaign()">{{
                base
              }}</reference>
              @if (!last) {
                ,
              }
            }
            )
          </div>
        }
        <ng-content select="[name]"></ng-content>
      </div>
      @if (overview()) {
        <div class="buttons">
          <button mat-icon-button class="collapse" (click)="onCollapse($event)">
            <mat-icon>unfold_less</mat-icon>
          </button>
          <button mat-icon-button class="expand" (click)="onExpand($event)"><mat-icon>unfold_more</mat-icon></button>
          <button mat-icon-button (click)="onFull($event)"><mat-icon>open_in_full</mat-icon></button>
        </div>
      }
    </div>
    <div class="subtitle"><ng-content select="[subtitle]"></ng-content></div>

    <taper></taper>
    <ng-content></ng-content>

    <div class="text"><ng-content select="[content]"></ng-content></div>

    <div class="short"><ng-content select="[short]"></ng-content></div>

    <div class="footer">
      <div class="references">
        @for (reference of references()?.references; track reference.name) {
          <reference [name]="reference.id" type="product">
            {{ reference.name }}
          </reference>
          {{ reference.formattedPages }}
        }
      </div>
    </div>
  </div>

  <div class="bar"></div>
</div>
