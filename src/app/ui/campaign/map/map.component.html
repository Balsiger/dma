<div class="canvas" [style.background]="map()?.background">
  <div
    class="image"
    [style.transform]="'scale(' + scale() + ')'"
    [style.left]="left() + 'px'"
    [style.top]="top() + 'px'"
  >
    <div class="rotate" [style.transform]="'rotate(' + rotation() + 'deg)'">
      @if (map()?.path) {
        <img src="/assets/maps/{{ map()?.path }}" />
      }
      @for (layer of layers(); track layer) {
        <img class="layer" src="/assets/maps/{{ layer }}" />
      }
      @for (token of tokens(); track token) {
        <img
          class="token"
          src="/assets/tokens/{{ token.token()?.image }}"
          [style.left]="token.x() + 'px'"
          [style.top]="token.y() + 'px'"
          [style.width]="token.widthPx * this.tokenScale() + 'px'"
          [style.height]="token.heightPx * this.tokenScale() + 'px'"
          [style.transform]="'rotate(' + token.rotation() + 'deg)'"
        />
      }
    </div>
  </div>

  @if (showGrid()) {
    <grid
      [width]="width"
      [height]="height"
      [distance]="gridPx()"
      [style.top]="(top() % gridPx()) + 'px'"
      [style.left]="(left() % gridPx()) + 'px'"
    ></grid>
  }
</div>
