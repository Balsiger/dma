@let entity = item();
@if (entity) {
  <entity-card [flippable]="flippable()" [imageIndex]="imageIndex()" [name]="entity.name"
   [image]="entity.common.images.length > 0 ? entity.common.images[0].url : ''"
   [tagline]="entity.shortDescription" [version]="entity.common.version"
   [references]="entity.reference.toString()">
    <div category>
      <img class="type-icon" [src]="'/assets/items/' + entity.type + '.webp'"/>
      <div class="type-text">{{entity.type}}</div>
    </div>

    <div stats class="money">
      <mat-icon class="stats-icon">toll</mat-icon>
      @if (entity.value.isEmpty()) {
        &mdash;
      } @else {
        {{entity.totalValue.text}}
      }
    </div>

    <div stats class="weight">
      <mat-icon class="stats-icon">scale</mat-icon>
      @if (entity.weight.isEmpty()) {
        &mdash;
      } @else {
        {{entity.totalWeight}}
      }
    </div>

    @if (entity.attunement) {
      <div top class="attunement">
        <mat-icon>album</mat-icon>
        <div class="caption">Attunement</div>
      </div>
    }

    <div top class="rarity">
      <img src="/assets/items/{{entity.rarity}}.webp"/>
      <div class="caption">{{entity.rarity}}</div>
    </div>

    <div description>
      @for (description of playerDescriptions(); track description) {
        <formatted-text [text]="description"></formatted-text>
      }
    </div>

    @if (entity.appliesTo.length > 0) {
      <div back-stats class="applies-to">
        Applies to any {{entity.appliesTo | list:' or '}}
        @if (entity.appliesToException) {
          , except {{entity.appliesToException}}
        }
      </div>
    }
  </entity-card>
}
